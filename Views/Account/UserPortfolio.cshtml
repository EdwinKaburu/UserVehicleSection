@model UserListVIew
@{
    ViewData["Title"] = "UserPortfolio";
    Layout = "~/Views/Shared/_Layout.cshtml";
}



<div class="grid-container fluid">
    <div class="grid-x">
        <div class="cell shrink">
            <ul class="vertical tabs" data-tabs id="example-tabs">
                <li class="tabs-title is-active"><a href="#panel1v" aria-selected="true">Profile</a></li>
                <li class="tabs-title"><a href="#panel2v">Vehicles</a></li>
                <li class="tabs-title"><a href="#panel3v">Messages</a></li>
            </ul>
        </div>
        <div class="cell auto">
            <div class="tabs-content vertical" data-tabs-content="example-tabs">
                <div class="tabs-panel is-active" id="panel1v">
                    <div class="grid-container fluid">
                        <div class="cell">

                            <div class="radius bordered shadow card">
                                <img class="thumbnail" src="https://get.foundation/sites/docs/assets/img/orbit/02.jpg">
                                <div class="card-divider">
                                    Your Profile Image
                                </div>
                                <div class="card-section">
                                    <h4>@Model.User.UserName</h4>
                                    <hr />

                                    <p>Email: @Model.User.UserEmail</p>
                                    <p>Address: @Model.User.UserAddress</p>
                                    <p>City: @Model.User.UserCity</p>
                                    <p>Country: @Model.User.UserCountry</p>
                                    <p>
                                        Description: @Model.User.UserDescription
                                    </p>
                                </div>
                            </div>

                        </div>
                    </div>
                </div>
                <div class="tabs-panel" id="panel2v">

                    <ul class="tabs" data-deep-link="true" data-update-history="true" data-deep-link-smudge="true" data-deep-link-smudge-delay="500" data-tabs id="deeplinked-tabs">
                        <li class="tabs-title is-active"><a href="#panel1d" aria-selected="true">List of Vehicles</a></li>
                        <li class="tabs-title"><a href="#panel2d">Service History</a></li>
                    </ul>

                    <div class="tabs-content" data-tabs-content="deeplinked-tabs">
                        <div class="tabs-panel is-active" id="panel1d">

                            <div class="grid-container fluid">
                                <div class="cell">
                                    <table class="hover">
                                        <thead>
                                            <tr>
                                                <th>Vehicle Make</th>
                                                <th>Vehicle Model</th>
                                                <th>Vehicle Year</th>
                                                <th>Vehicle Mileage</th>
                                                <th>Vehicle Vin Number</th>
                                                <th>Vehicle Actions</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            @foreach (var item in Model.UserVehDbs)
                                            {
                                                // string modal = "video"
                                                <tr>
                                                    <td>@item.VehicleMake</td>
                                                    <td>@item.VehicleModel</td>
                                                    <td>@item.VehicleYear</td>
                                                    <td>@item.VehicleMileage</td>
                                                    <td>@item.VehicleVinNum</td>
                                                    <td>
                                                        @*<p>
                                                                <i class="step fi-video size-72" style="width:auto" data-open="@item.VehicleMake">Here</i>
                                                            </p>*@

                                                        <div class="primary button-group">
                                                            <a onclick="location.href='@(Url.Action("VehReq","Account", new { vehID = item.VehicleId }))'" class="button">Submit Vehicle Request</a>
                                                            <a class="button">View Vehicle Service History</a>
                                                        </div>

                                                    </td>
                                                </tr>
                                            }
                                            <tr>
                                                <td>Honda</td>
                                                <td>Accord</td>
                                                <td>2005</td>
                                                <td>345732</td>
                                                <td>A37873H322</td>
                                                <td>
                                                    @*<p><button class="button" data-open="exampleModal11">Click me for a modal</button></p>*@
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                                <div class="cell auto">
                                    <a asp-controller="Account" asp-action="Vehicle" asp-route-id="@Model.User.UserId"> Add New Vehicle </a>
                                </div>
                            </div>


                        </div>
                        <div class="tabs-panel" id="panel2d">
                            @{
                                @*foreach(var item in Model.ServicedHistDbs)
                                    {
                                        <p>Vehicle Make: @item.VehReq.Vehicle.VehicleMake</p>
                                        <p>Vehicle Model: @item.VehReq.Vehicle.VehicleModel</p>
                                        <p>Requested Name: @item.VehReq.VehReqName</p>
                                        <p>Serviced : @item.Serviced</p>
                                    }*@

                                foreach (var item in Model.ServicedHistDbs)
                                {
                                    <p> Serviced : @item.Serviced</p>

                                    <p> VehicleReqName : @item.VehReq.VehReqName</p>

                                    <p> VehicleReq ID : @item.VehReq.VehReqId</p>

                                    <p> Vehicle: @item.VehReq.Vehicle.VehicleMake</p>

                                    <br /><br />
                                }
                            }
                        </div>
                    </div>




                </div>
                <div class="tabs-panel" id="panel3v">
                    <div class="grid-container fluid">
                        <div class="cell">

                            <table class="hover">
                                <thead>
                                    <tr>
                                        <th>Shop</th>
                                        <th>Message</th>
                                        <th>Message Date</th>
                                        <th>Request Name</th>
                                        <th>Request Date</th>
                                        <th>Vehicle Name</th>
                                        <th>Services</th>
                                        <th>Service Cost</th>
                                        <th>Vehicle Owner</th>

                                        <th>Action</th>
                                    </tr>
                                </thead>

                                <tbody>
                                    @{
                                        foreach (var alert in Model.MessageDbs)
                                        {
                                            decimal? totalCost = 0.0m;
                                            string reqSer = String.Empty;

                                            foreach (var service in alert.VehReq.ServiceReqDb)
                                            {
                                                totalCost += service.Assign.Service.ServiceCost;
                                                reqSer += $"{service.Assign.Service.ServiceName} : {service.Assign.Service.ServiceCost}\n";
                                            }

                                            <tr>
                                                <td>@alert.User.UserName</td>
                                                <td>@alert.Message</td>
                                                <td>@alert.MessageDate.Value</td>
                                                <td>@alert.VehReq.VehReqName</td>
                                                <td>@alert.VehReq.VehReqDate</td>
                                                <td>@alert.VehReq.Vehicle.VehicleMake</td>
                                                <td>@reqSer</td>
                                                <td>@totalCost</td>
                                                <td>@alert.VehReq.Vehicle.User.UserName</td>

                                                <td>
                                                    <div class="primary button-group">
                                                        <a onclick="location.href='@(Url.Action("Serviced","Account", new { vehID = alert.VehReqId, shopID = alert.User.UserId,serCost = totalCost, acceptance = true , shopPortfolio = false }))'" class="button">
                                                            Accept
                                                        </a>
                                                        <a onclick="location.href='@(Url.Action("Serviced","Account", new { vehID = alert.VehReqId, shopID = alert.User.UserId,serCost = totalCost, acceptance = false , shopPortfolio = false }))'" class="button">
                                                            Decline
                                                        </a>
                                                    </div>
                                                </td>
                                            </tr>
                                        }
                                    }

                                </tbody>

                            </table>

                        </div>
                    </div>

                </div>
            </div>
        </div>
    </div>
</div>

@*<div class="reveal" id="exampleModal11" aria-labelledby="exampleModalHeader11" data-reveal>
        <div class="grid-container fluid">
            <div class="grid-x">

                <div class="cell small-6">
                    <button type="button" class="button rounded bordered shadow secondary">
                        View Vehicle Service History
                    </button>

                </div>

                <div class="cell small-6">
                    <button type="button" class="button rounded bordered shadow secondary">
                        Submit Vehicle Request
                    </button>
                </div>

            </div>
        </div>
    </div>







                            foreach (var item in Model.UserVehDbs)
                            {
                                foreach (var item1 in item.VehReqDb)
                                {
                                    <p>Vehicle ID @item1.VehicleId </p>
                                    <p>Request Name @item1.VehReqName</p>
                                    <p>Request ID @item1.VehReqId</p>
                                    foreach (var message in item1.MessageDb)
                                    {
                                        <p>Message : @message.Message</p>
                                    }
                                }

                                <hr />
                            }
                            <br /> <br /><br /> <br /><br /> <br />


                            foreach (var request in Model.UserReqDbs)
                            {
                                <p>Vehicle ID: @request.Vehicle.VehicleId</p>
                                <p>Request Name:  @request.VehReqName</p>
                                <p>Request ID: @request.VehReqId</p>

                                <p>Shop: @request.User.UserName </p>
                                <p>Vehicle Owner : @request.Vehicle.User.UserName</p>

                                foreach (var input in request.MessageDb)
                                {
                                    <p>Message: @input.Message</p>
                                }

                                <hr />
                            }
                            <br /> <br /> <br /> <br /><br /> <br />

                            foreach (var ite in Model.MessageDbs)
                            {
                                <p> Shop : @ite.User.UserName</p>
                                <p> Vehicle ID : @ite.VehReq.VehicleId</p>
                                <p> Request Name : @ite.VehReq.VehReqName </p>
                                <p> Request ID : @ite.VehReqId </p>
                                <p> Vehicle Owner : @ite.VehReq.Vehicle.User.UserName</p>
                                <p>Message : @ite.Message</p>

                                <hr />
                            }














*@


