@model ListView

<script src="https://cdn.jsdelivr.net/npm/js-cookie@2/src/js.cookie.min.js"></script>
<script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>

@{
    ViewData["Title"] = "Vehicle";
    Layout = "~/Views/Shared/_Layout.cshtml";

    string alert = ViewBag.VehSuccess;

    if (alert != null)
    {
        <div class="callout success" data-closable>
            <h5>Vehicle Successfully Added</h5>
            <p>You can Redirect Back to the User Profile</p>
            <p>I'm using the default <code>data-closable</code> parameters, and simply fade out.</p>
            <button class="close-button" aria-label="Dismiss alert" type="button" data-close>
                <span aria-hidden="true">&times;</span>
            </button>
        </div>
    }
}


<form id="forms1" asp-action="Vehicle" asp-controller="Account" method="post">

    <div asp-validation-summary="ModelOnly" class="text-danger"></div>

    <div class="grid-container fluid">
        <div class="grid-x grid-margin-x">

            <div class="cell small-6">

                <span asp-validation-for="VehMake" class="text-danger"></span>

                <label asp-for="VehMake">
                    Select Your Make
                    <select id="combobox" class="makeID" asp-for="VehMake">
                       @foreach(var item in Model.Results)
                       {
                           <option>@item.MakeName</option>
                       }
                    </select>
                </label>

            </div>

            <div class="cell small-6">

                <span asp-validation-for="VehModel" class="text-danger"></span>

                <label id="vehModel" asp-for="VehModel">
                    Select Your Model
                    <select id="yourModels" asp-for="VehModel">
                    </select>
                </label>
            </div>
            <div class="cell small-6">

                <span asp-validation-for="VehMileage" class="text-danger"></span>

                <label>
                    Enter Your Vehicle Mileage
                    <input asp-for="VehMileage" />
                </label>
            </div>

            <div class="cell small-6">

                <span asp-validation-for="VehVinNum" class="text-danger"></span>

                <label>
                    Enter Your Vehicle Vin-Number
                    <input asp-for="VehVinNum" />
                </label>
            </div>
            <div class="cell small-6">

                <span asp-validation-for="VehYear" class="text-danger"></span>

                <label>
                    Enter Year Of Vehicle
                    <input asp-for="VehYear" />
                </label>
            </div>
            <div class="cell shrink">
                <button type="submit" class="button">Add Vehicle</button>
            </div>

        </div>
    </div>
</form>
<h3>
    @Model.VehVinNum

</h3>
<h3>
    @Model.VehModel
</h3>





@*<h1>Here : @Model.VehModel</h1>
    <div>
        <partial name="_Authors" />
    </div>
    <div>
        <partial name="_Model" />
    </div>*@

@*@await Html.PartialAsync("_Model",Model)*@

@*<h3>@Model.VehModel</h3>*@
<!-- Use Partial VIew for the Make , inorder to avoid reloading all the datasets-->
@*<label>
        Select Your Model
        <select id="yourModels">
        </select>
    </label>*@
@*<label id="vehModel">
        Select Your Model
        <select id="yourModels">
        </select>
    </label>*@

<script>
    // $(document).ready(function () {

    //var readCookie = $.cookie("Url")

    //$.ajax({
    //    url: readCookie,
    //    type: "GET",
    //    dataType: "json",
    //    success: function (data) {

    //        // data.Results
    //        //alert(data.Results);
    //        $.each(data.Results, function (index, value) {
    //            console.log(value.Model_Name);
    //            $('#yourModels').append(new Option(value.Model_Name, value.Model_Name));
    //            //$('#yourModels').append($('<option></option>').val(val).html(text))
    //            // Will stop running after "three"
    //            // return (value !== 'three');
    //        });


    //    }
    //});


    $("select.makeID").change(function () {
        var make = $(this).children("option:selected").val();
        //document.cookie = "Makes=" + make;
        //Cookies.set('Makess', make);
        //alert("You have selected the country - " + make);

        //$("#forms1").append('<label id="label1" asp-for="VehModel"> Select Your Vehicle </label>');
        //$("#label1").append('<select id="yourModel"></select>');


        //Json Selector Based on the Make Selector

        var makeUrl = 'https://vpic.nhtsa.dot.gov/api/vehicles/getmodelsformake/' + make + '?format=json';

        $.ajax({
            url: makeUrl,
            type: "GET",
            dataType: "json",
            success: function (data) {
                $('#yourModels').empty();
                console.clear();
                $.each(data.Results, function (index, value) {
                    console.log(value.Model_Name);
                    $('#yourModels').append(new Option(value.Model_Name, value.Model_Name));
                });


            }
        });
    });


   // });
</script>
@*<form>
        <label>Select Country:</label>
        <select class="country">
            <option>United States</option>
            <option>India</option>
            <option>United Kingdom</option>
        </select>
    </form>*@
@*












            onclick="location.href='@Url.Action("GetModels","Account",new { com = item.MakeName.Trim() })'"

        asp-for="@Model.VehMake"


          @{
                    foreach (var item in Model.Results)
                    {
                        <option>@item.MakeName</option>
                    }
                }
                @*<option value=""></option>
                    <option value="volvo">Volvo</option>
                    <option value="saab">Saab</option>
                    <option value="mercedes">Mercedes</option>
                    <option value="audi">Audi</option>


    ="location.href='@(Url.Action("GetModels","Account", new { com = "Honda" }))'"

    Combine the Two Api to get one the Make and the Model at https://vpic.nhtsa.dot.gov/api/vehicles/getmodelsformakeyear/make/honda/modelyear/2015?format=json and get the Year



    <script>
        $(document).ready(function () {
            $("select.makeID").change(function () {
                var make = $(this).children("option:selected").val();


                alert("You have selected the country - " + make);


                //var email = "{userInfo:{Id:\"2\", UserName:\"user1\", Description:\"Des\" },classInfo:{Id:\"3\",ClassName:\"class1\", Description:\"Des2\"}}";


                @*$.ajax({
                    type: 'POST',
                    url: "@Url.Action("GetModels","Account")",
                    dataType: 'json',
                    data: {
                        com: email,
                    },
                    success: function (status) {
                        console.log('Send' + email);
                    },
                    error: function () {
                        console.log('something went wrong - debug it!');
                    }
                });



            });
        });
    </script>


    asp-action="GetModels" asp-controller="Account"


     public IActionResult Vehicle([FromQuery(Name = "email")]string smodel)
            {
                return View(new ListView {
                    Results = _repo.GetVehichleMakesAsync().Result.Take(50),
                    VehModel = smodel
                });
            }










*@

